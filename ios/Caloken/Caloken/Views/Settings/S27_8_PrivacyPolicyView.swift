import SwiftUI

struct S27_8_PrivacyPolicyView: View {
    var body: some View {
        ScrollView {
            VStack(alignment: .leading, spacing: 24) {
                Text("制定日: 2025年12月12日")
                    .font(.system(size: 13))
                    .foregroundColor(.gray)
                
                // 前文
                Text("""
                株式会社Stella Creation（以下「当社」といいます。）は、当社が提供するスマートフォン用アプリケーション「カロ研」（以下「本アプリ」といいます。）および本アプリに関するサービス（以下「本サービス」といいます。）における、ユーザーの個人情報の取扱いについて、以下のとおりプライバシーポリシー（以下「本ポリシー」といいます。）を定めます。
                """)
                .font(.system(size: 14))
                .foregroundColor(.primary)
                .lineSpacing(4)
                
                // 第1条
                PrivacySection(
                    title: "第1条（収集する情報および収集方法）",
                    content: """
                    当社は、本サービスにおいて、以下の情報を収集・利用する場合があります。
                    
                    【ユーザーから直接ご提供いただく情報】
                    ・メールアドレス、アカウント情報（ユーザー登録時）
                    ・写真・画像データ（ユーザーが本アプリの機能を利用してアップロードしたもの）
                    ・お問い合わせ内容、フィードバック
                    
                    【自動的に収集される情報】
                    ・端末情報：デバイスの種類、OSバージョン、言語設定、端末識別子（UUID等）
                    ・ログ情報：本アプリの利用履歴、アクセス日時、操作ログ
                    ・クラッシュデータ：アプリが強制終了した際のエラーログ
                    ・Cookieおよび匿名ID
                    """
                )
                
                // 第2条
                PrivacySection(
                    title: "第2条（利用目的）",
                    content: """
                    当社は、収集した情報を以下の目的で利用します。
                    
                    ・本サービスの提供、維持、保護および改善のため
                    ・AI（人工知能）による画像解析およびカロリー・栄養素等の推定を行うため
                    ・ユーザーからのお問い合わせに対応するため
                    ・本サービスの利用状況を分析し、機能改善や新サービス開発に役立てるため
                    ・本規約やポリシーに違反する行為への対応および不正利用の防止のため
                    ・重要なお知らせやメンテナンス情報を通知するため
                    """
                )
                
                // 第3条
                PrivacySection(
                    title: "第3条（画像データの取扱いとAI処理）",
                    content: """
                    本アプリは、ユーザーがアップロードした食事等の画像を、AIを用いて解析・変換する機能を提供します。
                    
                    【外部AIサービスの利用】
                    画像処理および解析のために、以下の第三者が提供するサービス（API）を利用します。画像データは処理のために当該サービスのサーバー（米国等）へ送信されますが、当社および当該サービス提供者は、ユーザーの明示的な同意がない限り、ユーザーの画像を学習データとして永続的に保存・利用することはありません。
                    
                    ・Google Gemini（提供者: Google LLC / 所在: 米国）
                    
                    【権限について】
                    本アプリは、画像の撮影および選択のために、カメラおよびフォトライブラリへのアクセス権限を要求します。ユーザーは端末の設定により、いつでもこの権限を取り消すことができますが、その場合、本アプリの一部機能が利用できなくなる場合があります。
                    """
                )
                
                // 第4条
                PrivacySection(
                    title: "第4条（情報収集モジュールの利用）",
                    content: """
                    本アプリでは、利用状況の分析およびアプリの品質向上のため、以下の第三者が提供する情報収集モジュール（SDK）を組み込んでいます。これに伴い、以下の事業者がユーザー情報を自動的に取得する場合があります。
                    
                    【アクセス解析・利用状況分析】
                    ・Google Analytics for Firebase
                      提供者：Google LLC
                      取得項目：アプリの起動数、利用時間、デバイス情報等
                    
                    【クラッシュレポート（不具合解析）】
                    ・Firebase Crashlytics
                      提供者：Google LLC
                      取得項目：クラッシュログ、デバイス情報、UUID
                      目的：アプリの不具合修正、安定性向上のため
                    """
                )
                
                // 第5条
                PrivacySection(
                    title: "第5条（個人情報の第三者提供）",
                    content: """
                    当社は、以下の場合を除き、ユーザーの同意を得ることなく第三者に個人情報を提供しません。
                    
                    ・法令に基づく場合
                    ・人の生命、身体または財産の保護のために必要がある場合であって、本人の同意を得ることが困難であるとき
                    ・公衆衛生の向上または児童の健全な育成の推進のために特に必要がある場合であって、本人の同意を得ることが困難であるとき
                    ・国の機関もしくは地方公共団体またはその委託を受けた者が法令の定める事務を遂行することに対して協力する必要がある場合であって、本人の同意を得ることにより当該事務の遂行に支障を及ぼすおそれがあるとき
                    ・合併、会社分割、事業譲渡その他の事由により事業が承継される場合
                    """
                )
                
                // 第6条
                PrivacySection(
                    title: "第6条（個人情報の管理）",
                    content: """
                    当社は、個人情報の漏洩、滅失または毀損の防止その他、個人情報の安全管理のために必要かつ適切な措置を講じます。
                    """
                )
                
                // 第7条
                PrivacySection(
                    title: "第7条（利用者情報の開示・訂正・削除）",
                    content: """
                    ユーザーは、当社に対し、当社が保有する自己の個人情報の開示、訂正、追加、削除、利用停止を求めることができます。ご希望の場合は、第9条のお問い合わせ窓口までご連絡ください。当社は、本人確認を行った上で、法令の定めに従い適切に対応いたします。
                    """
                )
                
                // 第8条
                PrivacySection(
                    title: "第8条（プライバシーポリシーの変更）",
                    content: """
                    当社は、必要と判断した場合には、ユーザーに通知することなくいつでも本ポリシーを変更することができるものとします。ただし、法令上ユーザーの同意が必要となるような内容の変更を行う場合は、当社所定の方法でユーザーの同意を得るものとします。変更後のプライバシーポリシーは、本アプリ内に掲示された時点から効力を生じるものとします。
                    """
                )
                
                // 第9条
                PrivacySection(
                    title: "第9条（お問い合わせ窓口）",
                    content: """
                    本ポリシーに関するご質問やご意見は、以下の連絡先までお願いいたします。
                    
                    株式会社Stella Creation
                    住所：神奈川県川崎市多摩区宿河原5-25-23
                    メールアドレス：support@stellacreation.com
                    """
                )
                
                Spacer(minLength: 32)
            }
            .padding(20)
        }
        .background(Color(UIColor.systemBackground))
        .navigationTitle("プライバシーポリシー")
        .navigationBarTitleDisplayMode(.inline)
    }
}

// MARK: - プライバシーセクション
struct PrivacySection: View {
    let title: String
    let content: String
    
    var body: some View {
        VStack(alignment: .leading, spacing: 8) {
            Text(title)
                .font(.system(size: 16, weight: .bold))
                .foregroundColor(.primary)
            
            Text(content)
                .font(.system(size: 14))
                .foregroundColor(.primary)
                .lineSpacing(4)
        }
    }
}

#Preview {
    NavigationStack {
        S27_8_PrivacyPolicyView()
    }
}
